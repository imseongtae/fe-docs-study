# Understanding Your UI as a Tree

## Table of contents

1. [트리로서 UI 이해하기](#1-트리로서-ui-이해하기)
1. [Side Effects: (un)intended consequences](#2-렌더-트리)


---

## 1. 트리로서 UI 이해하기
**트리**는 요소와 UI 사이의 관계 모델이며, UI는 종종 트리 구조를 사용하여 표현됨

트리 사용의 예시:
- **브라우저**: HTML(DOM), CSS(CSSOM)를 트리 구조로 모델링함
- **모바일 플랫폼**: 뷰 계층 구조를 트리로 표현함
- **React**: 컴포넌트 간의 관계를 모델링하고 렌더링 흐름을 관리하기 위해 트리 구조 사용

> 트리는 React 앱에서 **데이터 흐름**, **렌더링**, **앱 크기 최적화** 방법 등을 이해하는 데 유용한 도구

⸻

## 2. 렌더 트리
렌더 트리는 React 컴포넌트 간의 렌더링 관계를 표현한 트리 구조:
- 각 노드는 하나의 컴포넌트를 나타냄.
- React 렌더 트리에서 루트 노드는 앱의 Root 컴포넌트(예시에서 루트 노드는 App. 최상위 컴포넌트)


```
graph TD;
  App --> FancyText
  App --> InspirationGenerator
  InspirationGenerator --> Copyright
  InspirationGenerator --> FancyText
  InspirationGenerator --> Color
```

### 루트 컴포넌트
**루트 컴포넌트(Root Component)**는 React 앱의 최상위 컴포넌트

> "최상위 컴포넌트는 루트 컴포넌트에 가장 가까운 컴포넌트이며, 그 아래의 모든 컴포넌트의 렌더링 성능에 영향을 미치며, 가장 복잡성이 높습니다"

특징:
- 보통 `index.js` 또는 `main.jsx` 등에서 `ReactDOM.render()` 또는 `createRoot().render()`로 가장 먼저 렌더링되는 컴포넌트
- 일반적으로 `App` 컴포넌트가 루트 컴포넌트 역할을 하며, 모든 다른 컴포넌트의 **부모**
- 렌더 트리의 **시작점**이자 **데이터 흐름의 출발점**

### 리프 컴포넌트

**리프 컴포넌트(Leaf Component)**는 렌더 트리에서 **자식 컴포넌트를 가지지 않는** 컴포넌트를 의미합니다.

특징:
- 트리의 가장 아래에 위치하며, 더 이상 렌더링할 하위 컴포넌트가 없음
- 주로 **텍스트, 버튼, 이미지, 아이콘**과 같이 UI의 단위 요소를 담당함
- 상태나 props가 바뀌면 자주 **다시 렌더링**되는 경향이 있음

---

## 3. 모듈 의존성 트리

> **모듈 의존성 트리**는 React 앱의 **모듈 간 import 관계**를 트리 구조로 모델링한 것

특징:
- 각 **노드**는 **JS 모듈**(컴포넌트, 함수, 상수 등)을 나타냄
- 각 **가지(branch)**는 해당 모듈의 **import 문**을 나타냄
- 컴포넌트를 분리하고 로직을 별도의 파일로 분리하면, 이러한 JS 모듈로 구성된 의존성 트리를 구성할 수 있음

예시:
- `'App.js'`는 `'InspirationGenerator.js'`, `'FancyText.js'`, `'Copyright.js'`를 import 함
- `'InspirationGenerator.js'`는 `'FancyText.js'`, `'Color.js'`, `'inspirations.js'`를 import 함

이 트리의 **루트 노드**는 앱의 **루트 모듈**로, 일반적으로 **루트 컴포넌트를 포함하는 모듈**이며, **엔트리 포인트 파일**이라고도 함

### 렌더 트리와의 차이점
- 렌더 트리는 **컴포넌트 인스턴스 간의 렌더링 관계**를 표현하지만, **의존성 트리는 모듈 간의 import 관계**를 표현
- **트리 노드는 컴포넌트가 아니라 모듈**
- `inspirations.js`와 같은 **비(非) 컴포넌트 모듈**도 포함됨
  - 예를 들어, `Copyright.js`는 `'App.js'`에서 import되지만, 렌더 트리 상에서는 `InspirationGenerator`의 자식으로 렌더링됨
  - 이는 `InspirationGenerator`가 **자식 props로 JSX를 허용**하여 `<Copyright />`를 렌더링하기 때문

### 용도 및 중요성
- **React 앱을 실행하기 위해 필요한 모듈을 결정**할 때 사용됨
- 앱을 프로덕션용으로 빌드할 때, **클라이언트에 제공할 모든 JavaScript를 하나의 번들로 묶는 작업**이 이루어짐
  - 이 작업은 **번들러**(예: Webpack, Vite 등)가 수행함
- 번들러는 의존성 트리를 분석하여 **포함해야 할 모듈을 결정**

### 성능 관련 시사점
- 앱이 커질수록 **의존성 트리도 커지고**, 번들 크기도 증가
- 번들 크기가 커지면 **클라이언트의 다운로드와 실행 비용**이 커지고, **UI 렌더링 지연**이 발생할 수 있음
- 이러한 문제를 디버깅하고 최적화 기회를 찾기 위해 의존성 트리를 분석하는 것이 중요
